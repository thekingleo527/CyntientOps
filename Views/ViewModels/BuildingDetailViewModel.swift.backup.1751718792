//
//  BuildingDetailViewModel.swift
//  FrancoSphere
//
//  Fixed constructor calls for BuildingStatistics and BuildingInsight
//

import Foundation
import SwiftUI

class BuildingDetailViewModel: ObservableObject {
    @Published var buildingStats: FrancoSphere.BuildingStatistics = FrancoSphere.BuildingStatistics(completionRate: 85.0, totalTasks: 20, completedTasks: 17
        totalTasks: 0,
        completedTasks: 0, 
        efficiency: 0.0,
        lastUpdated: Date()
    )
    
    @Published var insights: [FrancoSphere.BuildingInsight] = []
    @Published var isLoading = false
    @Published var errorMessage: String?
    
    private let building: NamedCoordinate
    
    init(building: NamedCoordinate) {
        self.building = building
        loadBuildingData()
    }
    
    private func loadBuildingData() {
        isLoading = true
        errorMessage = nil
        
        // Simulate loading
        DispatchQueue.main.asyncAfter(deadline: .now() + 1) {
            self.buildingStats = FrancoSphere.BuildingStatistics(completionRate: 85.0, totalTasks: 20, completedTasks: 17
                totalTasks: 25,
                completedTasks: 18,
                efficiency: 0.72,
                lastUpdated: Date()
            )
            
            self.insights = [
                FrancoSphere.BuildingInsight(
                    id: "1",
                    title: "High Efficiency",
                    description: "Building maintenance is performing well",
                    priority: 1
                ),
                FrancoSphere.BuildingInsight(
                    id: "2", 
                    title: "Scheduled Maintenance",
                    description: "HVAC system due for quarterly check",
                    priority: 2
                )
            ]
            
            self.isLoading = false
        }
    }
    
    func refreshData() {
        loadBuildingData()
    }
}
